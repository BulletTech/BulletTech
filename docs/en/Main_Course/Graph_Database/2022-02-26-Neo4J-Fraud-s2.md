---
template: overrides/blogs.html
tags:
  -Knowledge Graph
---

# Neo4j diagram database anti -fraud analysis actual combat (2) -Fit data

!!! Info
    Author: [vincent] (https://github.com/realvincentyuan), published in 2021-06-06, reading time: about 6 minutes, WeChat public account article link: [: fontaWesome-solid-Link:] (https://mp.weixin.qqpom/s ?__biz=mzi4mjk3nzgxoq==&mid=2247485256&IDX=1&Sn=0d87a1d090909823d2395372c8F43CDCE77D2AF7D2AF7D2AF7 5E6313E945A83F2309743E7E7E7E7E0855C99D9Ecece6F3D24F3AD06AE80A4 & Token = 771475859 & Lang = zh_cn#RD))

## 1 Introduction

In [NEO4J diagram database anti -fraud analysis actual combat (1) -Coly build an analytical environment] (https://mp.weixin.qq.com/s ?__biz=mzi4mjk3nzgxoq==2247485213&idx=1c8887847BCF35EF6E 21AF6005F4 & CHKSM = EB90F469DCE77D7FA1325810D537E183C65EF7067F20219EEE02D6F3667D14554832103986d & Token = 771475859 & LANG = zh_cn#RD) In this article, the operation of the NEO4J analysis platform and some basic map databases introduced. This article officially began to explore the theme of anti -fraud.The primary task is to clarify the goals, obtain data and sort out data.The example provided by NEO4J is concerned about fraudulent criminals to control a large number of accounts for fraud transactions using the same physical information, so the goal is to find out the connection between these accounts and the criminal gangs.However, this example does not introduce the source of the data and the arrangement of data, and this part is actually very critical in the real work, so this article will focus on explaining the part of the data preparation.

## 2 Get data

Neo4j provides [multiple methods] (https://neo4j.com/developer/data-import/ 'Import data to neo4j') connecting the data warehouse:

-The manual data
-Worne the CSV file
-Prod with API to import data
-In import data from the relational database
-In use of application -driven connection to import data (supporting multiple programming languages such as .NET, Java, JavaScript, GO, Python, etc.))

Among them, I want to use the Python driver to import data, because usually, you can first use the Python to obtain the original data in the relationship database, and use the NEO4J interface to connect multiple platforms to complete the data transmission work.Reading and writing speed is very fast. The following is the Pyspark example code. Please note that you need to download the corresponding [pyspark version of the NEO4J connector jar file] (https://github.com/neo4j-trib/neo4j- spnnector/releases'Neo4j Connector for Apache Spark').

<figure>
  <img src = "httts://cdn.jsdelivr.net/gh/bullettech2021/pics/img/1_v/neo4j connection information.png"/>/>
  <figcaption> neo4j connection information </figcaption>
</Figure>


`` `Python
# Read the data of NEO4J
#Chn the account password with the own settings
df = spark.read.format ("Org.neo4j.spark.datasource") \ \
     .opting ("url", "bolt+s: //63d2d43273493b399454b26961152ed9.neo4jsandbox.com: 7687") \ \ ") \ \") \ \ "
     .opting ("Authentication.type", "Basic") \ \) \
     .opting ("Authentication.basic.username", "neo4j") \
     .opting ("Authentication.basic.password", "Password") \
     .opting ("Labels", "Person") \ \
     .load ())

display (df)

# O to NEO4J
df2 = spark.createdataframe ([(1, "John"), (2, "thomas")],
 [ID "," name "]
Cure

df2.write.Format ("ORG.NEO4J.Spark.datasource") \ \
     .opting ("url", "bolt+s: //63d2d43273493b399454b26961152ed9.neo4jsandbox.com: 7687") \ \ ") \ \") \ \ "
     .opting ("Authentication.type", "Basic") \ \) \
     .opting ("Authentication.basic.username", "neo4j") \
     .opting ("Authentication.basic.password", "Password") \
     .opting ("Labels", ": Person") \) \
     .opting ("node.keys", "ID") \
     .mode ("OverWrite") \ \
     .save ()
`` `

Remember, before loading the data [define index] (https://neo4j.com/docs/cypher-manual/current/indexes-Search-perFormance/ 'Indexes for Search Performance'), this operation will significantly improve programs. OrderRun speed.

## 3 Define nodes and relationships

<figure>
  <img src = "https://cdn.jsdelivr.net/gh/bullettech2021/pics/img/1_v/ nodes and relationships .png"/>/>
  <figcaption> nodes and relationships </figcaption>
</Figure>

As shown in the figure, the colorful circle represents the node, and the connection between nodes is the relationship.In intuitive, the original data is a table, which contains some fields related to the target, and each field corresponds to this entity (node).

| Mule | PHONE | Email |
| ------ | -------------------------------------------------------------------------
| John | 888888888 | Demo@gmail.com |
| Tim | 7777777777 | demo2@gmail.com |

The node can be written in NEO4J with the above code.Relationship '), such as John has its own mailbox to define the following ways:

`` `SQL
Match
  (A: mule),
  (B: Email)
Where a.email = b.email
Create (a)-[r: have_email]-> (b)
Return Type (R)
`` `

In this kind of push, the useful relationship of targets can be defined in this way.

## 4 Data Overview

The first part of the anti -fraud example described the data to analyze the data, such as the number of nodes, the number of relationships, and other information, which helps help understand the data and check the integrity of the data. Make sure that the data you need is stored in accordance with the set goals.NEO4J, the module is relatively intuitive, not to repeat it too much.

<figure>
  <img src = "https://cdn.jsdelivr.net/gh/bullettech2021/pics/img/1_v/ Description statistics .png"/>/>
  <figcaption> descriptive analysis </figcaption>
</Figure>

## 5 Summary

This article solves the initial doubts of many beginners of the map database. How to import data (usually tables) into NEO4J, and define nodes and relationships that serve the target.There is no doubt that this is the basis of the follow -up analysis work, and then you can formally analyze these data against fraud.I hope this sharing will help you, please leave a message in the comment area!

<figure>
  <img src = "httts://cdn.jsdelivr.net/gh/bullettech2021/pics/2021-6-14/1623639526512-1080p%20hd)%20tail .png" widt "widt" widt "widt h = "500 " />
</Figure>
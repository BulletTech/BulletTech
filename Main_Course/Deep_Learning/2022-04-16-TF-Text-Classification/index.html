<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="We are a team of a few data scientists working in the financial industry. Here is the place where we share practical analytics skills, working and life experience. Enjoy your time here!"><meta name=author content="BulletTech Team"><link href=https://bullettech.github.io/BulletTech/Main_Course/Deep_Learning/2022-04-16-TF-Text-Classification/ rel=canonical><link rel=icon href=../../../assets/images/Bullet_No_text.svg><meta name=generator content="mkdocs-1.3.0, mkdocs-material-7.3.4"><title>使用TensorFlow进行文本分类 - BulletTech</title><link rel=stylesheet href=../../../assets/stylesheets/main.db9e7362.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.3f5d1f46.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-198351102-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script><script async src=https://www.google-analytics.com/analytics.js></script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=black data-md-color-accent=deep-purple> <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#tensorflow class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=BulletTech class="md-header__button md-logo" aria-label=BulletTech data-md-component=logo> <?xml version="1.0" encoding="UTF-8" standalone="no"?> <!-- Created with Vectornator for iOS (http://vectornator.io/) --><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg height=100% style=fill-rule:nonzero;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round; xmlns:xlink=http://www.w3.org/1999/xlink xmlns=http://www.w3.org/2000/svg xml:space=preserve width=100% xmlns:vectornator=http://vectornator.io version=1.1 viewbox="0 0 1024 1024"> <metadata> <vectornator:setting key=DimensionsVisible value=1 /> <vectornator:setting key=PencilOnly value=0 /> <vectornator:setting key=SnapToPoints value=0 /> <vectornator:setting key=OutlineMode value=0 /> <vectornator:setting key=CMYKEnabledKey value=0 /> <vectornator:setting key=RulersVisible value=1 /> <vectornator:setting key=SnapToEdges value=0 /> <vectornator:setting key=GuidesVisible value=1 /> <vectornator:setting key=DisplayWhiteBackground value=1 /> <vectornator:setting key=doHistoryDisabled value=0 /> <vectornator:setting key=SnapToGuides value=1 /> <vectornator:setting key=TimeLapseWatermarkDisabled value=0 /> <vectornator:setting key=Units value=Pixels /> <vectornator:setting key=DynamicGuides value=0 /> <vectornator:setting key=IsolateActiveLayer value=0 /> <vectornator:setting key=SnapToGrid value=0 /> </metadata> <defs/> <g id="Layer 1" vectornator:layername="Layer 1"> <g opacity=1> <path d=M599.561+5.15683e-05C525.331-0.0600209+445.238+52.3758+400.829+96.7849L49.9196+447.694L79.1737+476.948L49.9196+506.202L35.3159+491.552C27.2334+483.469+14.1443+483.469+6.06183+491.552C-2.02062+499.634-2.0206+512.723+6.06183+520.806L210.747+725.491C218.829+733.573+231.919+733.573+240.001+725.491C248.084+717.408+248.084+704.366+240.001+696.283L225.351+681.633L254.605+652.379L283.859+681.633L634.768+330.724C699.363+266.129+780.955+126.049+693.229+38.3233C665.815+10.9092+633.301+0.0273572+599.561+5.15683e-05ZM596.724+41.858C610.995+41.574+624.754+43.824+637.512+49.3924C599.24+55.3109+524.614+75.169+445.896+141.852L430.083+126.039C464.105+92.0161+534.883+43.0884+596.724+41.858ZM393.899+127.341L604.212+337.7L578.446+363.42L368.133+153.107L393.899+127.341ZM108.381+506.202L225.351+623.171L196.143+652.379L79.1737+535.456L108.381+506.202Z opacity=1 fill=#ffffff /> <path d=M475.257+171.244C565.742+96.0695+639.046+91.2036+678.779+87.1332C716.326+155.313+648.824+258.186+605.511+301.499L475.257+171.244Z opacity=1 fill=#ffffff /> <path d=M971.203+379.557C1008.75+447.737+941.242+550.603+897.929+593.916L767.674+463.662C858.16+388.487+931.463+383.621+971.203+379.557Z opacity=1 fill=#ffffff /> <path d=M891.961+292.401C817.732+292.341+737.638+344.823+693.229+389.232L342.32+740.141L371.575+769.349L342.32+798.603L327.717+783.999C319.634+775.917+306.545+775.917+298.463+783.999C290.38+792.081+290.38+805.124+298.463+813.206L503.148+1017.94C511.23+1026.02+524.319+1026.02+532.402+1017.94C540.484+1009.86+540.484+996.767+532.402+988.684L517.798+974.08L547.006+944.826L576.26+974.08L927.169+623.171C991.764+558.576+1073.4+418.449+985.677+330.724C958.263+303.31+925.702+292.428+891.961+292.401ZM889.124+334.259C903.397+333.976+917.2+336.223+929.959+341.793C891.676+347.7+817.021+367.622+738.296+434.299L722.483+418.486C756.506+384.463+827.279+335.484+889.124+334.259ZM685.102+419.789L895.415+630.101L869.696+655.821L659.383+445.508L685.102+419.789ZM400.829+798.603L517.798+915.572L488.544+944.826L371.575+827.857L400.829+798.603Z opacity=1 fill=#ffffff /> </g> </g> </svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> BulletTech </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 使用TensorFlow进行文本分类 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=black data-md-color-accent=deep-purple aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=amber aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/BulletTech/BulletTech title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> BulletTech/BulletTech </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=http://bullettech.cn/ class=md-tabs__link> Product Center </a> </li> <li class=md-tabs__item> <a href=../../../Main_course_blog_intro/ class="md-tabs__link md-tabs__link--active"> Main Course </a> </li> <li class=md-tabs__item> <a href=../../../Dessert_blog_intro/ class=md-tabs__link> Dessert </a> </li> <li class=md-tabs__item> <a href=../../../About_us/ class=md-tabs__link> About Us </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=BulletTech class="md-nav__button md-logo" aria-label=BulletTech data-md-component=logo> <?xml version="1.0" encoding="UTF-8" standalone="no"?> <!-- Created with Vectornator for iOS (http://vectornator.io/) --><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg height=100% style=fill-rule:nonzero;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round; xmlns:xlink=http://www.w3.org/1999/xlink xmlns=http://www.w3.org/2000/svg xml:space=preserve width=100% xmlns:vectornator=http://vectornator.io version=1.1 viewbox="0 0 1024 1024"> <metadata> <vectornator:setting key=DimensionsVisible value=1 /> <vectornator:setting key=PencilOnly value=0 /> <vectornator:setting key=SnapToPoints value=0 /> <vectornator:setting key=OutlineMode value=0 /> <vectornator:setting key=CMYKEnabledKey value=0 /> <vectornator:setting key=RulersVisible value=1 /> <vectornator:setting key=SnapToEdges value=0 /> <vectornator:setting key=GuidesVisible value=1 /> <vectornator:setting key=DisplayWhiteBackground value=1 /> <vectornator:setting key=doHistoryDisabled value=0 /> <vectornator:setting key=SnapToGuides value=1 /> <vectornator:setting key=TimeLapseWatermarkDisabled value=0 /> <vectornator:setting key=Units value=Pixels /> <vectornator:setting key=DynamicGuides value=0 /> <vectornator:setting key=IsolateActiveLayer value=0 /> <vectornator:setting key=SnapToGrid value=0 /> </metadata> <defs/> <g id="Layer 1" vectornator:layername="Layer 1"> <g opacity=1> <path d=M599.561+5.15683e-05C525.331-0.0600209+445.238+52.3758+400.829+96.7849L49.9196+447.694L79.1737+476.948L49.9196+506.202L35.3159+491.552C27.2334+483.469+14.1443+483.469+6.06183+491.552C-2.02062+499.634-2.0206+512.723+6.06183+520.806L210.747+725.491C218.829+733.573+231.919+733.573+240.001+725.491C248.084+717.408+248.084+704.366+240.001+696.283L225.351+681.633L254.605+652.379L283.859+681.633L634.768+330.724C699.363+266.129+780.955+126.049+693.229+38.3233C665.815+10.9092+633.301+0.0273572+599.561+5.15683e-05ZM596.724+41.858C610.995+41.574+624.754+43.824+637.512+49.3924C599.24+55.3109+524.614+75.169+445.896+141.852L430.083+126.039C464.105+92.0161+534.883+43.0884+596.724+41.858ZM393.899+127.341L604.212+337.7L578.446+363.42L368.133+153.107L393.899+127.341ZM108.381+506.202L225.351+623.171L196.143+652.379L79.1737+535.456L108.381+506.202Z opacity=1 fill=#ffffff /> <path d=M475.257+171.244C565.742+96.0695+639.046+91.2036+678.779+87.1332C716.326+155.313+648.824+258.186+605.511+301.499L475.257+171.244Z opacity=1 fill=#ffffff /> <path d=M971.203+379.557C1008.75+447.737+941.242+550.603+897.929+593.916L767.674+463.662C858.16+388.487+931.463+383.621+971.203+379.557Z opacity=1 fill=#ffffff /> <path d=M891.961+292.401C817.732+292.341+737.638+344.823+693.229+389.232L342.32+740.141L371.575+769.349L342.32+798.603L327.717+783.999C319.634+775.917+306.545+775.917+298.463+783.999C290.38+792.081+290.38+805.124+298.463+813.206L503.148+1017.94C511.23+1026.02+524.319+1026.02+532.402+1017.94C540.484+1009.86+540.484+996.767+532.402+988.684L517.798+974.08L547.006+944.826L576.26+974.08L927.169+623.171C991.764+558.576+1073.4+418.449+985.677+330.724C958.263+303.31+925.702+292.428+891.961+292.401ZM889.124+334.259C903.397+333.976+917.2+336.223+929.959+341.793C891.676+347.7+817.021+367.622+738.296+434.299L722.483+418.486C756.506+384.463+827.279+335.484+889.124+334.259ZM685.102+419.789L895.415+630.101L869.696+655.821L659.383+445.508L685.102+419.789ZM400.829+798.603L517.798+915.572L488.544+944.826L371.575+827.857L400.829+798.603Z opacity=1 fill=#ffffff /> </g> </g> </svg> </a> BulletTech </label> <div class=md-nav__source> <a href=https://github.com/BulletTech/BulletTech title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> BulletTech/BulletTech </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Home </a> </li> <li class=md-nav__item> <a href=http://bullettech.cn/ class=md-nav__link> Product Center </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3> Main Course <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Main Course" data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Main Course </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Main_course_blog_intro/ class=md-nav__link> Intro </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2> Data Analytics <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Data Analytics" data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Data Analytics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Data_Analytics/2022-01-03-ANOVA/ class=md-nav__link> 方差分析 </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-12-15-min_n_choice/ class=md-nav__link> 最小样本量n的选取 </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-10-30-kdd-cup2021/ class=md-nav__link> KDD Cup2021时间序列异常检测竞赛总结 </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-10-26-Data-Search-and-Sort/ class=md-nav__link> 浅谈数据的搜索和排序 </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-09-20-pyspark_intro/ class=md-nav__link> PySpark小介 </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-08-27-SQL-tips-2/ class=md-nav__link> SQL Tips 2 </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-08-18-Sql-tips/ class=md-nav__link> SQL Tips </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-08-20-practical-recursion-for-data-cleaning/ class=md-nav__link> 利用递归思想处理半结构化数据 </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-07-18-PayPal-Job-Crawler/ class=md-nav__link> PayPal职位爬虫 </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-07-16-Timeseries-algo/ class=md-nav__link> 时间序列异常检测 </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-07-01-pdf-Crawler/ class=md-nav__link> 爬取并下载URL不变的pdf文件 </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-06-28-AB-Testing/ class=md-nav__link> A/B测试实战项目 </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-06-24-DID/ class=md-nav__link> 双重差分小介 </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-06-14-Wechat-Crawler/ class=md-nav__link> 微信小程序爬虫 </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-06-08-Taobao-Auto-Order-Script/ class=md-nav__link> 淘宝自动抢单 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3 checked> <label class=md-nav__link for=__nav_3_3> Deep Learning <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Deep Learning" data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Deep Learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../2022-05-20-CNN-Explainer/ class=md-nav__link> 卷积神经网络解释器简介 </a> </li> <li class=md-nav__item> <a href=../2022-05-14-TF-Time-Series-Univariate/ class=md-nav__link> 使用TensorFlow进行单变量时间序列预测 </a> </li> <li class=md-nav__item> <a href=../2022-05-07-TF-Playground/ class=md-nav__link> TensorFlow Playground简介 </a> </li> <li class=md-nav__item> <a href=../2022-04-24-TensorFlow-Decision-Forest/ class=md-nav__link> 使用TensorFlow Decision Forests构建树模型 </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> 使用TensorFlow进行文本分类 <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> 使用TensorFlow进行文本分类 </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#1 class=md-nav__link> 1 前言 </a> </li> <li class=md-nav__item> <a href=#2 class=md-nav__link> 2 获取数据 </a> </li> <li class=md-nav__item> <a href=#3 class=md-nav__link> 3 文本预处理 </a> <nav class=md-nav aria-label="3 文本预处理"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#31 class=md-nav__link> 3.1 转换文字大小写 </a> </li> <li class=md-nav__item> <a href=#32 class=md-nav__link> 3.2 文本格式化 </a> </li> <li class=md-nav__item> <a href=#33 class=md-nav__link> 3.3 构建词表 </a> </li> <li class=md-nav__item> <a href=#34 class=md-nav__link> 3.4 构建词表映射 </a> </li> <li class=md-nav__item> <a href=#35 class=md-nav__link> 3.5 配置数据集 </a> </li> <li class=md-nav__item> <a href=#36 class=md-nav__link> 3.6 处理测试集 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#4 class=md-nav__link> 4 建立模型 </a> <nav class=md-nav aria-label="4 建立模型"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#41-sequential-api class=md-nav__link> 4.1 使用Sequential API构建卷积神经网络 </a> </li> <li class=md-nav__item> <a href=#42-functional-apilstm class=md-nav__link> 4.2 使用Functional API构建双向LSTM </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#5 class=md-nav__link> 5 总结 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../2021-12-27-TensorFlow-Recommender2/ class=md-nav__link> TensorFlow推荐系统（二） </a> </li> <li class=md-nav__item> <a href=../2021-12-18-Tabnet/ class=md-nav__link> TabNet模型介绍 </a> </li> <li class=md-nav__item> <a href=../2021-12-10-Tensorflow-Recommender/ class=md-nav__link> TensorFlow推荐系统（一） </a> </li> <li class=md-nav__item> <a href=../2021-12-01-Tensorflow-Doc/ class=md-nav__link> 读《30天吃掉那只TensorFlow2》 </a> </li> <li class=md-nav__item> <a href=../2021-11-04-Deep-Learning-101-ResNet/ class=md-nav__link> 深度学习 101-搭建 ResNet 识别鲜花图像 </a> </li> <li class=md-nav__item> <a href=../2021-10-10-multi-algo/ class=md-nav__link> 算法中的multi家族 </a> </li> <li class=md-nav__item> <a href=../2021-10-10-TF-on-M1-Mac/ class=md-nav__link> 在Apple Silicon Macs上安装TensorFlow </a> </li> <li class=md-nav__item> <a href=../2021-10-04-Keras-Custom-Model/ class=md-nav__link> 使用tf.keras自定义模型 </a> </li> <li class=md-nav__item> <a href=../2021-10-02-TF-Callbacks/ class=md-nav__link> Keras各种Callbacks介绍 </a> </li> <li class=md-nav__item> <a href=../../Machine_Learning/2021-09-10-params-tuning-tricks/ class=md-nav__link> 神经网络调参技巧 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_4 type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4> Machine Learning <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Machine Learning" data-md-level=2> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Machine Learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Machine_Learning/2022-02-03-Uplift-Model/ class=md-nav__link> 因果推断之Uplift Model </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2022-01-30-Kaggle-exp-s2/ class=md-nav__link> Kaggle量化竞赛Top方案 </a> </li> <li class=md-nav__item> <a href=../../Machine_Learning/2022-01-28-Ensemble-Learning/ class=md-nav__link> 集成学习小介 </a> </li> <li class=md-nav__item> <a href=../../Machine_Learning/2022-01-22-Permutation-importance/ class=md-nav__link> 特征选择之Permutation Importance </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-09-26-feature-selection/ class=md-nav__link> 特征选择小介 </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-09-25-Feature-engineering/ class=md-nav__link> 金融风控特征工程 </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-09-02-Kaggle-janestreet/ class=md-nav__link> Kaggle Jane Street </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-08-27-Kaggle-optiver/ class=md-nav__link> Kaggle Optiver </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-08-10-Kaggle-tips/ class=md-nav__link> Kaggle tips </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-08-08-Loan-Default-Competition-Review/ class=md-nav__link> 天池零基础金融风控比赛小结 </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-07-24-notes-of-rules-of-ML2.0/ class=md-nav__link> 读《Rules of Machine Learning》有感（下） </a> </li> <li class=md-nav__item> <a href=../../Data_Analytics/2021-07-22-notes-of-rules-of-ML/ class=md-nav__link> 读《Rules of Machine Learning》有感（上） </a> </li> <li class=md-nav__item> <a href=../../Machine_Learning/2021-08-28-Decision-Tree/ class=md-nav__link> 决策树学习笔记 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_5 type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5> Graph <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Graph data-md-level=2> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Graph </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Graph_Database/2022-04-09-Neo4J-Fraud-s4/ class=md-nav__link> Neo4J图数据库反欺诈分析实战（四） - 风险评分 </a> </li> <li class=md-nav__item> <a href=../../Graph_Database/2022-03-06-Neo4J-Fraud-s3/ class=md-nav__link> Neo4J图数据库反欺诈分析实战（三） - 识别犯罪团伙 </a> </li> <li class=md-nav__item> <a href=../../Graph_Database/2022-02-26-Neo4J-Fraud-s2/ class=md-nav__link> Neo4J图数据库反欺诈分析实战（二） - 准备数据 </a> </li> <li class=md-nav__item> <a href=../../Graph_Database/2022-01-29-Neo4J-Fraud-s1/ class=md-nav__link> Neo4J图数据库反欺诈分析实战（一） - 搭建分析环境 </a> </li> <li class=md-nav__item> <a href=../../Graph_Database/2021-12-13-Graph_Database_Introduction/ class=md-nav__link> 初识图数据库 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_6 type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6> Analytics Tool <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Analytics Tool" data-md-level=2> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Analytics Tool </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Analytics_Tools/2021-12-09-Docker2/ class=md-nav__link> Docker踩坑日记 </a> </li> <li class=md-nav__item> <a href=../../Analytics_Tools/2021-11-25-Docker-Volumes/ class=md-nav__link> Docker之数据的持续性化 </a> </li> <li class=md-nav__item> <a href=../../Analytics_Tools/2021-11-20-GitHub-Docker/ class=md-nav__link> 使用GitHub Action自动推送Docker镜像 </a> </li> <li class=md-nav__item> <a href=../../Analytics_Tools/2021-11-13-Docker-Windows/ class=md-nav__link> 教你成功在Win10系统中运行docker </a> </li> <li class=md-nav__item> <a href=../../Analytics_Tools/2021-11-13-GitHub-Action/ class=md-nav__link> GitHub Action概览 </a> </li> <li class=md-nav__item> <a href=../../Analytics_Tools/2021-11-05-Docker-Sharing/ class=md-nav__link> Docker初体验 </a> </li> <li class=md-nav__item> <a href=../../Analytics_Tools/2021-11-01-GitHub-Resume/ class=md-nav__link> 用GitHub做一份精美的在线简历 </a> </li> <li class=md-nav__item> <a href=../../Analytics_Tools/2021-10-14-play-with-github/ class=md-nav__link> GitHub也可以很好玩 </a> </li> <li class=md-nav__item> <a href=../../Analytics_Tools/2021-10-11-SF-Access-Intro/ class=md-nav__link> SnowFlake权限概览 </a> </li> <li class=md-nav__item> <a href=../../Analytics_Tools/2021-09-11-SF-Archi-Intro/ class=md-nav__link> SnowFlake架构概览 </a> </li> <li class=md-nav__item> <a href=../../Analytics_Tools/2021-07-31-GA-Intro/ class=md-nav__link> 浅谈Google Analytics </a> </li> <li class=md-nav__item> <a href=../../Analytics_Tools/2021-07-15-Git-Commands/ class=md-nav__link> Git常用命令一览 </a> </li> <li class=md-nav__item> <a href=../../Analytics_Tools/2021-06-23-Github-Intro/ class=md-nav__link> 一行代码都不写，教你使用GitHub </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_7 type=checkbox id=__nav_3_7> <label class=md-nav__link for=__nav_3_7> Coding <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Coding data-md-level=2> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Coding </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Coding/2021-11-21-Python-argparse/ class=md-nav__link> 命令行交互工具argparse </a> </li> <li class=md-nav__item> <a href=../../Coding/2021-10-16-Python-package-sqlparse/ class=md-nav__link> 语法解析工具sqlparse </a> </li> <li class=md-nav__item> <a href=../../Coding/2021-09-21-Python-Closure/ class=md-nav__link> Python闭包浅析 </a> </li> <li class=md-nav__item> <a href=../../Coding/2021-08-21-Python-dict/ class=md-nav__link> Python字典常用操作小技巧 </a> </li> <li class=md-nav__item> <a href=../../Coding/2021-08-14-Python-list/ class=md-nav__link> Python列表常用操作小技巧 </a> </li> <li class=md-nav__item> <a href=../../Coding/2021-08-07-Python-Tuple/ class=md-nav__link> Python元组常用操作小技巧 </a> </li> <li class=md-nav__item> <a href=../../Coding/2021-08-03-useful-python-packages/ class=md-nav__link> 好用的Python包 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_8 type=checkbox id=__nav_3_8> <label class=md-nav__link for=__nav_3_8> One Day Build <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="One Day Build" data-md-level=2> <label class=md-nav__title for=__nav_3_8> <span class="md-nav__icon md-icon"></span> One Day Build </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../One_Day_Build/2022-01-03-domain/ class=md-nav__link> 域名注册及备案全流程 </a> </li> <li class=md-nav__item> <a href=../../One_Day_Build/2021-12-04-renting_data/ class=md-nav__link> 租房信息获取 </a> </li> <li class=md-nav__item> <a href=../../One_Day_Build/2021-11-27-fund_data/ class=md-nav__link> 获取基金行情数据 </a> </li> <li class=md-nav__item> <a href=../../One_Day_Build/2021-11-10-12306ticket/ class=md-nav__link> 12306智能订票 </a> </li> <li class=md-nav__item> <a href=../../One_Day_Build/2021-10-29-flaskbb2/ class=md-nav__link> 解读FlaskBB源码 </a> </li> <li class=md-nav__item> <a href=../../One_Day_Build/2021-10-21-flaskbb/ class=md-nav__link> 基于FlaskBB自建论坛 </a> </li> <li class=md-nav__item> <a href=../../One_Day_Build/2021-06-21-Mining/ class=md-nav__link> 利用显卡实现咖啡自由 </a> </li> <li class=md-nav__item> <a href=../../One_Day_Build/2021-06-05-blockchain_intro/ class=md-nav__link> Python实现简单区块链货币 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> Dessert <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Dessert data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Dessert </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Dessert_blog_intro/ class=md-nav__link> Intro </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2 type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2> Hardware <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Hardware data-md-level=2> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Hardware </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Dessert/Hardware/2021-06-03-Mac-mini/ class=md-nav__link> M1 Mac mini 使用半年体验 - Mac的新未来 </a> </li> <li class=md-nav__item> <a href=../../../Dessert/Hardware/2021-01-02-Apple-Watch-S5/ class=md-nav__link> Apple Watch S5 使用一年感受 - 不后悔！ </a> </li> <li class=md-nav__item> <a href=../../../Dessert/Hardware/2020-04-05-iPad-Pro/ class=md-nav__link> 初识2020款12.9英寸iPad Pro - 未来可期 </a> </li> <li class=md-nav__item> <a href=../../../Dessert/Hardware/2020-03-14-MX-Keys/ class=md-nav__link> 换种姿势，在家办公 - 罗技MX Keys + M720主观评测 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3 type=checkbox id=__nav_4_3> <label class=md-nav__link for=__nav_4_3> Apps <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Apps data-md-level=2> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> Apps </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Dessert/Apps/2022-01-04-Z-Library/ class=md-nav__link> Z-Library，优质科研电子书下载平台 </a> </li> <li class=md-nav__item> <a href=../../../Dessert/Apps/2021-12-25-Apache/ class=md-nav__link> Apache项目介绍 </a> </li> <li class=md-nav__item> <a href=../../../Dessert/Apps/2021-11-26-APIintro/ class=md-nav__link> 有趣的API介绍1.0 </a> </li> <li class=md-nav__item> <a href=../../../Dessert/Apps/2021-10-29-iOS-Shortcuts/ class=md-nav__link> iOS Shortcuts捷径 </a> </li> <li class=md-nav__item> <a href=../../../Dessert/Apps/2021-10-23-PicGo/ class=md-nav__link> PicGo图床，功能刚刚好 </a> </li> <li class=md-nav__item> <a href=../../../Dessert/Apps/2021-07-19-Copilot/ class=md-nav__link> Copilot测试版本体验 </a> </li> <li class=md-nav__item> <a href=../../../Dessert/Apps/2021-07-12-Paste/ class=md-nav__link> Paste - 剪切板工具 </a> </li> <li class=md-nav__item> <a href=../../../Dessert/Apps/2021-06-15-Hotapps/ class=md-nav__link> 装机必备之实用电脑软件 </a> </li> <li class=md-nav__item> <a href=../../../Dessert/Apps/2021-06-06-Notion/ class=md-nav__link> 个人笔记应用 - Notion </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4 type=checkbox id=__nav_4_4> <label class=md-nav__link for=__nav_4_4> Exp <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Exp data-md-level=2> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Exp </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Dessert/Tactics/2021-07-02-Posting-Workflow/ class=md-nav__link> 如何以最快的速度写出一篇优美的文章 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> About Us <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="About Us" data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> About Us </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../About_us/ class=md-nav__link> 关于BulletTech </a> </li> <li class=md-nav__item> <a href=../../../Our_story/ class=md-nav__link> 我们的故事 </a> </li> <li class=md-nav__item> <a href=../../../Dessert/Tactics/2021-11-17-Articles-Review/ class=md-nav__link> “年终”文章回顾及新菜单发布 </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#1 class=md-nav__link> 1 前言 </a> </li> <li class=md-nav__item> <a href=#2 class=md-nav__link> 2 获取数据 </a> </li> <li class=md-nav__item> <a href=#3 class=md-nav__link> 3 文本预处理 </a> <nav class=md-nav aria-label="3 文本预处理"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#31 class=md-nav__link> 3.1 转换文字大小写 </a> </li> <li class=md-nav__item> <a href=#32 class=md-nav__link> 3.2 文本格式化 </a> </li> <li class=md-nav__item> <a href=#33 class=md-nav__link> 3.3 构建词表 </a> </li> <li class=md-nav__item> <a href=#34 class=md-nav__link> 3.4 构建词表映射 </a> </li> <li class=md-nav__item> <a href=#35 class=md-nav__link> 3.5 配置数据集 </a> </li> <li class=md-nav__item> <a href=#36 class=md-nav__link> 3.6 处理测试集 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#4 class=md-nav__link> 4 建立模型 </a> <nav class=md-nav aria-label="4 建立模型"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#41-sequential-api class=md-nav__link> 4.1 使用Sequential API构建卷积神经网络 </a> </li> <li class=md-nav__item> <a href=#42-functional-apilstm class=md-nav__link> 4.2 使用Functional API构建双向LSTM </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#5 class=md-nav__link> 5 总结 </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=tensorflow>使用TensorFlow进行文本分类<a class=headerlink href=#tensorflow title="Permanent link">&para;</a></h1> <div class="admonition info"> <p class=admonition-title>Info</p> <p>作者：袁子弹起飞，发布于2022-04-16，阅读时间：约4分钟，微信公众号文章链接：<a href="https://mp.weixin.qq.com/s?__biz=MzI4Mjk3NzgxOQ==&mid=2247485273&idx=1&sn=d672fbcc65edeb115f628ad231caeca8&chksm=eb90f42ddce77d3b680b48c9cda52db5f96e3d3a64fc1bf94537dae7efa1a9f8908016572e35&token=200682583&lang=zh_CN#rd"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M172.5 131.1c55.6-55.59 148-55.59 203.6 0 50 50 57.4 129.7 16.3 187.2l-1.1 1.6c-10.3 14.3-30.3 17.7-44.6 7.4-14.4-10.3-17.8-30.3-7.5-44.6l1.1-1.6c22.9-32.1 19.3-76-8.6-103.9-31.4-31.4-82.5-31.4-114 0L105.5 289.5c-31.51 30.6-31.51 82.5 0 114 27.8 27.9 71.8 31.5 103.8 8.6l1.6-2c14.4-9.4 34.4-6.1 44.6 8.3 10.3 14.4 7 34.4-7.4 44.7l-1.6 1.1c-58.4 41.1-136.3 34.5-186.29-15.4-56.469-56.5-56.469-148.1 0-204.5L172.5 131.1zm295 248.9c-56.5 56.5-148 56.5-204.5 0-50-50-56.5-128.8-15.4-186.3l1.1-1.6c9.4-14.3 29.4-17.7 44.6-7.4 14.4 9.4 17.8 29.4 7.5 44.6l-1.1 1.6c-22.9 31.2-19.3 76 8.6 103.9 31.4 31.4 82.5 31.4 114 0l112.2-112.3c31.5-31.5 31.5-83.4 0-114-27.8-27.87-71.8-31.51-103.8-8.6l-1.6 1.1c-14.4 10.3-34.4 6.1-44.6-7.42-10.3-14.38-7-34.37 7.4-44.64l1.6-1.12C451 6.731 529.8 13.25 579.8 63.24c56.5 56.46 56.5 148.06 0 204.46L467.5 380z"/></svg></span></a></p> </div> <h2 id=1>1 前言<a class=headerlink href=#1 title="Permanent link">&para;</a></h2> <p>在自然语言处理中，文本分类是非常普遍的应用，本文将介绍使用TensorFlow开发基于嵌入（Embedding）的文本分类模型，由于TensorFlow的API变化迅速且兼容性感人，因此本文均使用的截至2022年4月16日最新版的TensorFlow(tf)及相关库，主要包括：<code>TensorFlow（v2.8.0）</code>，<code>TensorFlow Datasets（tfds v4.0.1）</code>和<code>TensorFlow Text（tf_text v2.8.1）</code>，如遇bug，请首先检查TensorFlow相关库的版本。此工作流主要使用的API有：</p> <ul> <li>tf.strings</li> <li>tfds</li> <li>tf_text</li> <li>tf.data.Dataset</li> <li>tf.keras (Sequential &amp; Functional API)</li> </ul> <h2 id=2>2 获取数据<a class=headerlink href=#2 title="Permanent link">&para;</a></h2> <p>TensorFlow Datasets（tfds）里含有非常多的<a href=https://www.tensorflow.org/datasets title="TensorFlow Datasets数据集">示例数据</a>用于研究试验，本文使用经典的电影评论数据，进行情感二分类任务的研究。首先使用tfds的API直接加载数据，结果将存在一个<a href=https://www.tensorflow.org/api_docs/python/tf/data/Dataset title=tf.data.Dataset>tf.data.Dataset</a>对象中。</p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>collections</span>
<span class=kn>import</span> <span class=nn>pathlib</span>

<span class=kn>import</span> <span class=nn>tensorflow</span> <span class=k>as</span> <span class=nn>tf</span>
<span class=kn>from</span> <span class=nn>tensorflow.keras</span> <span class=kn>import</span> <span class=n>layers</span>
<span class=kn>from</span> <span class=nn>tensorflow.keras</span> <span class=kn>import</span> <span class=n>losses</span>
<span class=kn>from</span> <span class=nn>tensorflow.keras</span> <span class=kn>import</span> <span class=n>utils</span>
<span class=kn>from</span> <span class=nn>tensorflow.keras.layers</span> <span class=kn>import</span> <span class=n>TextVectorization</span>

<span class=kn>import</span> <span class=nn>tensorflow_datasets</span> <span class=k>as</span> <span class=nn>tfds</span>
<span class=kn>import</span> <span class=nn>tensorflow_text</span> <span class=k>as</span> <span class=nn>tf_text</span>

<span class=kn>import</span> <span class=nn>plotly.express</span> <span class=k>as</span> <span class=nn>px</span>
<span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>


<span class=c1># Training set.</span>
<span class=n>train_ds</span> <span class=o>=</span> <span class=n>tfds</span><span class=o>.</span><span class=n>load</span><span class=p>(</span>
    <span class=s1>&#39;imdb_reviews&#39;</span><span class=p>,</span>
    <span class=n>split</span><span class=o>=</span><span class=s1>&#39;train[:80%]&#39;</span><span class=p>,</span>
    <span class=n>shuffle_files</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>as_supervised</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># Validation set - a tf.data.Dataset object</span>
<span class=n>val_ds</span> <span class=o>=</span> <span class=n>tfds</span><span class=o>.</span><span class=n>load</span><span class=p>(</span>
    <span class=s1>&#39;imdb_reviews&#39;</span><span class=p>,</span>
    <span class=n>split</span><span class=o>=</span><span class=s1>&#39;train[80%:]&#39;</span><span class=p>,</span>
    <span class=n>shuffle_files</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>as_supervised</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>


<span class=c1># Check the count of records</span>
<span class=nb>print</span><span class=p>(</span><span class=n>train_ds</span><span class=o>.</span><span class=n>cardinality</span><span class=p>()</span><span class=o>.</span><span class=n>numpy</span><span class=p>())</span>
<span class=nb>print</span><span class=p>(</span><span class=n>val_ds</span><span class=o>.</span><span class=n>cardinality</span><span class=p>()</span><span class=o>.</span><span class=n>numpy</span><span class=p>())</span>
</code></pre></div> <p>返回值为：</p> <div class=highlight><pre><span></span><code>20000
5000
</code></pre></div> <p>使用如下方法查看一条示例数据:</p> <div class=highlight><pre><span></span><code><span class=k>for</span> <span class=n>data</span><span class=p>,</span> <span class=n>label</span> <span class=ow>in</span>  <span class=n>train_ds</span><span class=o>.</span><span class=n>take</span><span class=p>(</span><span class=mi>1</span><span class=p>):</span>
  <span class=nb>print</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=n>data</span><span class=p>))</span>
  <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Text:&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>.</span><span class=n>numpy</span><span class=p>())</span>
  <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Label:&#39;</span><span class=p>,</span> <span class=n>label</span><span class=o>.</span><span class=n>numpy</span><span class=p>())</span>
</code></pre></div> <p>返回值为:</p> <div class=highlight><pre><span></span><code>&lt;class &#39;tensorflow.python.framework.ops.EagerTensor&#39;&gt;
Text: b&quot;This was an absolutely terrible movie. Don&#39;t be lured in by Christopher Walken or Michael Ironside. Both are great actors, but this must simply be their worst role in history. Even their great acting could not redeem this movie&#39;s ridiculous storyline. This movie is an early nineties US propaganda piece. The most pathetic scenes were those when the Columbian rebels were making their cases for revolutions. Maria Conchita Alonso appeared phony, and her pseudo-love affair with Walken was nothing but a pathetic emotional plug in a movie that was devoid of any real meaning. I am disappointed that there are movies like this, ruining actor&#39;s like Christopher Walken&#39;s good name. I could barely sit through it.&quot;
Label: 0
</code></pre></div> <h2 id=3>3 文本预处理<a class=headerlink href=#3 title="Permanent link">&para;</a></h2> <p>该小节使用tf_text和tf.stings的处理文本的API对数据进行处理，tf.data.Dataset能够很方便地将对应的函数映射到数据中，推荐学习和使用。</p> <h3 id=31>3.1 转换文字大小写<a class=headerlink href=#31 title="Permanent link">&para;</a></h3> <p>分类任务中字符大小写对模型预测没有贡献，因此对dataset使用<code>map</code>操作把所有字符转为小写，务必注意tf.data.Dataset里的数据格式。</p> <div class=highlight><pre><span></span><code><span class=n>train_ds</span> <span class=o>=</span> <span class=n>train_ds</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>text</span><span class=p>,</span> <span class=n>label</span><span class=p>:</span> <span class=p>(</span><span class=n>tf_text</span><span class=o>.</span><span class=n>case_fold_utf8</span><span class=p>(</span><span class=n>text</span><span class=p>),</span> <span class=n>label</span><span class=p>))</span>
<span class=n>val_ds</span> <span class=o>=</span> <span class=n>val_ds</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>text</span><span class=p>,</span> <span class=n>label</span><span class=p>:</span> <span class=p>(</span><span class=n>tf_text</span><span class=o>.</span><span class=n>case_fold_utf8</span><span class=p>(</span><span class=n>text</span><span class=p>),</span> <span class=n>label</span><span class=p>))</span>
</code></pre></div> <h3 id=32>3.2 文本格式化<a class=headerlink href=#32 title="Permanent link">&para;</a></h3> <p>该步骤对文本使用正则表达式进行格式化处理，如标点前后加上空格，利于后续步骤使用空格分词。</p> <div class=highlight><pre><span></span><code><span class=n>str_regex_pattern</span> <span class=o>=</span> <span class=p>[(</span><span class=s2>&quot;[^A-Za-z0-9(),!?</span><span class=se>\&#39;</span><span class=s2>\`]&quot;</span><span class=p>,</span> <span class=s2>&quot; &quot;</span><span class=p>),(</span><span class=s2>&quot;</span><span class=se>\&#39;</span><span class=s2>s&quot;</span><span class=p>,</span> <span class=s2>&quot; </span><span class=se>\&#39;</span><span class=s2>s&quot;</span><span class=p>,)</span> <span class=p>,(</span><span class=s2>&quot;</span><span class=se>\&#39;</span><span class=s2>ve&quot;</span><span class=p>,</span> <span class=s2>&quot; </span><span class=se>\&#39;</span><span class=s2>ve&quot;</span><span class=p>),(</span><span class=s2>&quot;n</span><span class=se>\&#39;</span><span class=s2>t&quot;</span><span class=p>,</span> <span class=s2>&quot; n</span><span class=se>\&#39;</span><span class=s2>t&quot;</span><span class=p>),(</span><span class=s2>&quot;</span><span class=se>\&#39;</span><span class=s2>re&quot;</span><span class=p>,</span> <span class=s2>&quot; </span><span class=se>\&#39;</span><span class=s2>re&quot;</span><span class=p>),(</span><span class=s2>&quot;</span><span class=se>\&#39;</span><span class=s2>d&quot;</span><span class=p>,</span> <span class=s2>&quot; </span><span class=se>\&#39;</span><span class=s2>d&quot;</span><span class=p>)</span>
<span class=p>,(</span><span class=s2>&quot;</span><span class=se>\&#39;</span><span class=s2>ll&quot;</span><span class=p>,</span> <span class=s2>&quot; </span><span class=se>\&#39;</span><span class=s2>ll&quot;</span><span class=p>),(</span><span class=s2>&quot;,&quot;</span><span class=p>,</span> <span class=s2>&quot; , &quot;</span><span class=p>),(</span><span class=s2>&quot;!&quot;</span><span class=p>,</span> <span class=s2>&quot; ! &quot;</span><span class=p>),(</span><span class=s2>&quot;\(&quot;</span><span class=p>,</span> <span class=s2>&quot; \( &quot;</span><span class=p>),(</span><span class=s2>&quot;\)&quot;</span><span class=p>,</span> <span class=s2>&quot; \) &quot;</span><span class=p>),(</span><span class=s2>&quot;\?&quot;</span><span class=p>,</span> <span class=s2>&quot; \? &quot;</span><span class=p>),(</span><span class=s2>&quot;\s{2,}&quot;</span><span class=p>,</span> <span class=s2>&quot; &quot;</span><span class=p>)]</span>

<span class=k>for</span> <span class=n>pattern</span><span class=p>,</span> <span class=n>rewrite</span> <span class=ow>in</span> <span class=n>str_regex_pattern</span><span class=p>:</span>
  <span class=n>train_ds</span> <span class=o>=</span> <span class=n>train_ds</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>text</span><span class=p>,</span> <span class=n>label</span><span class=p>:</span> <span class=p>(</span><span class=n>tf</span><span class=o>.</span><span class=n>strings</span><span class=o>.</span><span class=n>regex_replace</span><span class=p>(</span><span class=n>text</span><span class=p>,</span> <span class=n>pattern</span><span class=o>=</span><span class=n>pattern</span><span class=p>,</span> <span class=n>rewrite</span><span class=o>=</span><span class=n>rewrite</span><span class=p>),</span> <span class=n>label</span><span class=p>))</span>
  <span class=n>val_ds</span> <span class=o>=</span> <span class=n>val_ds</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>text</span><span class=p>,</span> <span class=n>label</span><span class=p>:</span> <span class=p>(</span><span class=n>tf</span><span class=o>.</span><span class=n>strings</span><span class=o>.</span><span class=n>regex_replace</span><span class=p>(</span><span class=n>text</span><span class=p>,</span> <span class=n>pattern</span><span class=o>=</span><span class=n>pattern</span><span class=p>,</span> <span class=n>rewrite</span><span class=o>=</span><span class=n>rewrite</span><span class=p>),</span> <span class=n>label</span><span class=p>))</span>
</code></pre></div> <h3 id=33>3.3 构建词表<a class=headerlink href=#33 title="Permanent link">&para;</a></h3> <p>使用训练集构造词表（注意不要使用验证集或者测试集，会导致信息泄露），该步骤将字符映射到相应的索引，利于将数据转化为模型能够进行训练和预测的格式。</p> <div class=highlight><pre><span></span><code><span class=c1># Do not use validation set as that will lead to data leak</span>
<span class=n>train_text</span> <span class=o>=</span> <span class=n>train_ds</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>text</span><span class=p>,</span> <span class=n>label</span><span class=p>:</span> <span class=n>text</span><span class=p>)</span>

<span class=n>tokenizer</span> <span class=o>=</span> <span class=n>tf_text</span><span class=o>.</span><span class=n>WhitespaceTokenizer</span><span class=p>()</span>

<span class=n>unique_tokens</span> <span class=o>=</span> <span class=n>collections</span><span class=o>.</span><span class=n>defaultdict</span><span class=p>(</span><span class=k>lambda</span><span class=p>:</span> <span class=mi>0</span><span class=p>)</span>
<span class=n>sentence_length</span> <span class=o>=</span>  <span class=p>[]</span>
<span class=k>for</span> <span class=n>text</span> <span class=ow>in</span> <span class=n>train_text</span><span class=o>.</span><span class=n>as_numpy_iterator</span><span class=p>():</span>
  <span class=n>tokens</span> <span class=o>=</span> <span class=n>tokenizer</span><span class=o>.</span><span class=n>tokenize</span><span class=p>(</span><span class=n>text</span><span class=p>)</span><span class=o>.</span><span class=n>numpy</span><span class=p>()</span>
  <span class=n>sentence_length</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>tokens</span><span class=p>))</span>
  <span class=k>for</span> <span class=n>token</span> <span class=ow>in</span> <span class=n>tokens</span><span class=p>:</span>
    <span class=n>unique_tokens</span><span class=p>[</span><span class=n>token</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>

<span class=c1># check out the average sentence length -&gt; ~250 tokens</span>
<span class=nb>print</span><span class=p>(</span><span class=nb>sum</span><span class=p>(</span><span class=n>sentence_length</span><span class=p>)</span><span class=o>/</span><span class=nb>len</span><span class=p>(</span><span class=n>sentence_length</span><span class=p>))</span>

<span class=c1># print 10 most used tokens - token, frequency</span>
<span class=n>d_view</span> <span class=o>=</span> <span class=p>[</span> <span class=p>(</span><span class=n>v</span><span class=p>,</span><span class=n>k</span><span class=p>)</span> <span class=k>for</span> <span class=n>k</span><span class=p>,</span><span class=n>v</span> <span class=ow>in</span> <span class=n>unique_tokens</span><span class=o>.</span><span class=n>items</span><span class=p>()]</span>
<span class=n>d_view</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>  
<span class=k>for</span> <span class=n>v</span><span class=p>,</span><span class=n>k</span> <span class=ow>in</span> <span class=n>d_view</span><span class=p>[:</span><span class=mi>10</span><span class=p>]:</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=si>%s</span><span class=s2>: </span><span class=si>%d</span><span class=s2>&quot;</span> <span class=o>%</span> <span class=p>(</span><span class=n>k</span><span class=p>,</span><span class=n>v</span><span class=p>))</span>
</code></pre></div> <p>返回值显示，高频使用的词都是英语中常见的字符：</p> <div class=highlight><pre><span></span><code>b&#39;the&#39;: 269406
b&#39;,&#39;: 221098
b&#39;and&#39;: 131502
b&#39;a&#39;: 130309
b&#39;of&#39;: 116695
b&#39;to&#39;: 108605
b&#39;is&#39;: 88351
b&#39;br&#39;: 81558
b&#39;it&#39;: 77094
b&#39;in&#39;: 75177
</code></pre></div> <p>也可以使用图表直观地展示每个词的使用频率，这一步有利于帮助选择词表的大小。</p> <div class=highlight><pre><span></span><code><span class=n>fig</span> <span class=o>=</span> <span class=n>px</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>d_view</span><span class=p>)),</span> <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=n>cnt</span> <span class=k>for</span> <span class=n>cnt</span><span class=p>,</span> <span class=n>word</span> <span class=ow>in</span> <span class=n>d_view</span><span class=p>])</span>
<span class=n>fig</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <figure> <img src=https://cdn.jsdelivr.net/gh/BulletTech2021/Pics/img/1_V/vocab_plot.png> <figcaption>词的使用频率分布</figcaption> </figure> <p>由图可见，在七万多个字符中，许多字符出现的频率极低，因此选择词表大小为两万。</p> <h3 id=34>3.4 构建词表映射<a class=headerlink href=#34 title="Permanent link">&para;</a></h3> <p>使用TensorFlow的<code>tf.lookup.StaticVocabularyTable</code>对字符进行映射，其能将字符映射到对应的索引上，并使用一个简单的样本进行测试。</p> <div class=highlight><pre><span></span><code><span class=n>keys</span> <span class=o>=</span> <span class=p>[</span><span class=n>token</span> <span class=k>for</span> <span class=n>cnt</span><span class=p>,</span> <span class=n>token</span> <span class=ow>in</span> <span class=n>d_view</span><span class=p>][:</span><span class=n>vocab_size</span><span class=p>]</span>
<span class=n>values</span> <span class=o>=</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>keys</span><span class=p>)</span> <span class=o>+</span> <span class=mi>2</span><span class=p>)</span>  <span class=c1># Reserve `0` for padding, `1` for OOV tokens.</span>

<span class=n>num_oov_buckets</span> <span class=o>=</span><span class=mi>1</span>

<span class=c1># Note: must assign the key_dtype and value_dtype when the keys and values are Python arrays</span>
<span class=n>init</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>lookup</span><span class=o>.</span><span class=n>KeyValueTensorInitializer</span><span class=p>(</span>
    <span class=n>keys</span><span class=o>=</span> <span class=n>keys</span><span class=p>,</span>
    <span class=n>values</span><span class=o>=</span> <span class=n>values</span><span class=p>,</span>
    <span class=n>key_dtype</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>string</span><span class=p>,</span> <span class=n>value_dtype</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>int64</span><span class=p>)</span>

<span class=n>table</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>lookup</span><span class=o>.</span><span class=n>StaticVocabularyTable</span><span class=p>(</span>
   <span class=n>init</span><span class=p>,</span>
   <span class=n>num_oov_buckets</span><span class=o>=</span><span class=n>num_oov_buckets</span><span class=p>)</span>

<span class=c1># Test the look up table with sample input</span>
<span class=n>input_tensor</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>constant</span><span class=p>([</span><span class=s2>&quot;emerson&quot;</span><span class=p>,</span> <span class=s2>&quot;lake&quot;</span><span class=p>,</span> <span class=s2>&quot;palmer&quot;</span><span class=p>,</span> <span class=s2>&quot;king&quot;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=n>table</span><span class=p>[</span><span class=n>input_tensor</span><span class=p>]</span><span class=o>.</span><span class=n>numpy</span><span class=p>())</span>
</code></pre></div> <p>输出为：</p> <div class=highlight><pre><span></span><code>array([20000,  2065, 14207,   618])
</code></pre></div> <p>接下来就可以将文本映射到索引上了，构造一个函数用于转化，并将它作用到数据集上：</p> <div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>text_index_lookup</span><span class=p>(</span><span class=n>text</span><span class=p>,</span> <span class=n>label</span><span class=p>):</span>
  <span class=n>tokenized</span> <span class=o>=</span> <span class=n>tokenizer</span><span class=o>.</span><span class=n>tokenize</span><span class=p>(</span><span class=n>text</span><span class=p>)</span>
  <span class=n>vectorized</span> <span class=o>=</span> <span class=n>table</span><span class=o>.</span><span class=n>lookup</span><span class=p>(</span><span class=n>tokenized</span><span class=p>)</span>
  <span class=k>return</span> <span class=n>vectorized</span><span class=p>,</span> <span class=n>label</span>

<span class=n>train_ds</span> <span class=o>=</span> <span class=n>train_ds</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=n>text_index_lookup</span><span class=p>)</span>
<span class=n>val_ds</span> <span class=o>=</span> <span class=n>val_ds</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=n>text_index_lookup</span><span class=p>)</span>
</code></pre></div> <h3 id=35>3.5 配置数据集<a class=headerlink href=#35 title="Permanent link">&para;</a></h3> <p>借助tf.data.Dataset的<code>cache</code>和<code>prefetch</code>API，能够有效提高性能，<code>cache</code>方法将数据加载在内存中用于快速读写，而<code>prefetch</code>则能够在模型预测时同步处理数据，提高时间利用率。</p> <div class=highlight><pre><span></span><code><span class=n>AUTOTUNE</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>AUTOTUNE</span>

<span class=k>def</span> <span class=nf>configure_dataset</span><span class=p>(</span><span class=n>dataset</span><span class=p>):</span>
  <span class=k>return</span> <span class=n>dataset</span><span class=o>.</span><span class=n>cache</span><span class=p>()</span><span class=o>.</span><span class=n>prefetch</span><span class=p>(</span><span class=n>buffer_size</span><span class=o>=</span><span class=n>AUTOTUNE</span><span class=p>)</span>

<span class=n>train_ds</span> <span class=o>=</span> <span class=n>configure_dataset</span><span class=p>(</span><span class=n>train_ds</span><span class=p>)</span>
<span class=n>val_ds</span> <span class=o>=</span> <span class=n>configure_dataset</span><span class=p>(</span><span class=n>val_ds</span><span class=p>)</span>
</code></pre></div> <p>文本长短不一，但神经网络需要输入数据具有固定的维度，因此对数据进行padding确保长度一致，并分批次。</p> <div class=highlight><pre><span></span><code><span class=n>BATCH_SIZE</span> <span class=o>=</span> <span class=mi>32</span>
<span class=n>train_ds</span> <span class=o>=</span> <span class=n>train_ds</span><span class=o>.</span><span class=n>padded_batch</span><span class=p>(</span><span class=n>BATCH_SIZE</span>  <span class=p>)</span>
<span class=n>val_ds</span> <span class=o>=</span> <span class=n>val_ds</span><span class=o>.</span><span class=n>padded_batch</span><span class=p>(</span><span class=n>BATCH_SIZE</span>  <span class=p>)</span>
</code></pre></div> <h3 id=36>3.6 处理测试集<a class=headerlink href=#36 title="Permanent link">&para;</a></h3> <p>用于验证模型性能的测试集也可以使用同样的方式处理，确保模型可以正常预测：</p> <div class=highlight><pre><span></span><code><span class=c1># Test set.</span>
<span class=n>test_ds</span> <span class=o>=</span> <span class=n>tfds</span><span class=o>.</span><span class=n>load</span><span class=p>(</span>
    <span class=s1>&#39;imdb_reviews&#39;</span><span class=p>,</span>
    <span class=n>split</span><span class=o>=</span><span class=s1>&#39;test&#39;</span><span class=p>,</span>
    <span class=c1># batch_size=BATCH_SIZE,</span>
    <span class=n>shuffle_files</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>as_supervised</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=n>test_ds</span> <span class=o>=</span> <span class=n>test_ds</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>text</span><span class=p>,</span> <span class=n>label</span><span class=p>:</span> <span class=p>(</span><span class=n>tf_text</span><span class=o>.</span><span class=n>case_fold_utf8</span><span class=p>(</span><span class=n>text</span><span class=p>),</span> <span class=n>label</span><span class=p>))</span>

<span class=k>for</span> <span class=n>pattern</span><span class=p>,</span> <span class=n>rewrite</span> <span class=ow>in</span> <span class=n>str_regex_pattern</span><span class=p>:</span>
  <span class=n>test_ds</span> <span class=o>=</span> <span class=n>test_ds</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>text</span><span class=p>,</span> <span class=n>label</span><span class=p>:</span> <span class=p>(</span><span class=n>tf</span><span class=o>.</span><span class=n>strings</span><span class=o>.</span><span class=n>regex_replace</span><span class=p>(</span><span class=n>text</span><span class=p>,</span> <span class=n>pattern</span><span class=o>=</span><span class=n>pattern</span><span class=p>,</span> <span class=n>rewrite</span><span class=o>=</span><span class=n>rewrite</span><span class=p>),</span> <span class=n>label</span><span class=p>))</span>

<span class=n>test_ds</span> <span class=o>=</span> <span class=n>test_ds</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=n>text_index_lookup</span><span class=p>)</span>
<span class=n>test_ds</span> <span class=o>=</span> <span class=n>configure_dataset</span><span class=p>(</span><span class=n>test_ds</span><span class=p>)</span>
<span class=n>test_ds</span> <span class=o>=</span> <span class=n>test_ds</span><span class=o>.</span><span class=n>padded_batch</span><span class=p>(</span><span class=n>BATCH_SIZE</span>  <span class=p>)</span>
</code></pre></div> <h2 id=4>4 建立模型<a class=headerlink href=#4 title="Permanent link">&para;</a></h2> <h3 id=41-sequential-api>4.1 使用Sequential API构建卷积神经网络<a class=headerlink href=#41-sequential-api title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=n>vocab_size</span> <span class=o>+=</span> <span class=mi>2</span> <span class=c1># 0 for padding and 1 for oov token</span>

<span class=k>def</span> <span class=nf>create_model</span><span class=p>(</span><span class=n>vocab_size</span><span class=p>,</span> <span class=n>num_labels</span><span class=p>,</span> <span class=n>dropout_rate</span><span class=p>):</span>
  <span class=n>model</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>Sequential</span><span class=p>([</span>
      <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Embedding</span><span class=p>(</span><span class=n>vocab_size</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=n>mask_zero</span><span class=o>=</span><span class=kc>True</span><span class=p>),</span>

      <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Conv1D</span><span class=p>(</span><span class=mi>32</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>padding</span><span class=o>=</span><span class=s2>&quot;valid&quot;</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s2>&quot;relu&quot;</span><span class=p>,</span> <span class=n>strides</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span>
      <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>MaxPooling1D</span><span class=p>(</span><span class=n>pool_size</span><span class=o>=</span><span class=mi>2</span><span class=p>),</span>

      <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Conv1D</span><span class=p>(</span><span class=mi>64</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=n>padding</span><span class=o>=</span><span class=s2>&quot;valid&quot;</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s2>&quot;relu&quot;</span><span class=p>,</span> <span class=n>strides</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span>
      <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>MaxPooling1D</span><span class=p>(</span><span class=n>pool_size</span><span class=o>=</span><span class=mi>2</span><span class=p>),</span>

      <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Conv1D</span><span class=p>(</span><span class=mi>128</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=n>padding</span><span class=o>=</span><span class=s2>&quot;valid&quot;</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s2>&quot;relu&quot;</span><span class=p>,</span> <span class=n>strides</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span>
      <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>GlobalMaxPooling1D</span><span class=p>(</span> <span class=p>),</span>

      <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Dropout</span><span class=p>(</span><span class=n>dropout_rate</span><span class=p>),</span>

      <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Dense</span><span class=p>(</span><span class=n>num_labels</span><span class=p>)</span>
  <span class=p>])</span>
  <span class=k>return</span> <span class=n>model</span>

<span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>backend</span><span class=o>.</span><span class=n>clear_session</span><span class=p>()</span>
<span class=n>model</span> <span class=o>=</span> <span class=n>create_model</span><span class=p>(</span><span class=n>vocab_size</span><span class=o>=</span><span class=n>vocab_size</span><span class=p>,</span> <span class=n>num_labels</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>dropout_rate</span><span class=o>=</span><span class=mf>0.5</span><span class=p>)</span>

<span class=c1># 在SGD中使用momentum将显著提高收敛速度</span>
<span class=n>loss</span> <span class=o>=</span> <span class=n>losses</span><span class=o>.</span><span class=n>SparseCategoricalCrossentropy</span><span class=p>(</span><span class=n>from_logits</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=n>optimizer</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>optimizers</span><span class=o>.</span><span class=n>SGD</span><span class=p>(</span><span class=n>learning_rate</span><span class=o>=</span><span class=mf>0.01</span><span class=p>,</span> <span class=n>momentum</span><span class=o>=</span><span class=mf>0.9</span><span class=p>)</span>

<span class=n>model</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=n>loss</span><span class=o>=</span><span class=n>loss</span><span class=p>,</span> <span class=n>optimizer</span><span class=o>=</span><span class=n>optimizer</span><span class=p>,</span> <span class=n>metrics</span><span class=o>=</span><span class=s1>&#39;accuracy&#39;</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>summary</span><span class=p>())</span>
</code></pre></div> <p>输出为：</p> <div class=highlight><pre><span></span><code>Model: &quot;sequential&quot;
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 embedding (Embedding)       (None, None, 128)         2560256   

 conv1d (Conv1D)             (None, None, 32)          12320     

 max_pooling1d (MaxPooling1D  (None, None, 32)         0         
 )                                                               

 conv1d_1 (Conv1D)           (None, None, 64)          8256      

 max_pooling1d_1 (MaxPooling  (None, None, 64)         0         
 1D)                                                             

 conv1d_2 (Conv1D)           (None, None, 128)         41088     

 global_max_pooling1d (Globa  (None, 128)              0         
 lMaxPooling1D)                                                  

 dropout (Dropout)           (None, 128)               0         

 dense (Dense)               (None, 2)                 258       

=================================================================
Total params: 2,622,178
Trainable params: 2,622,178
Non-trainable params: 0
_________________________________________________________________
</code></pre></div> <p>接下来即可训练、评估模型：</p> <div class=highlight><pre><span></span><code><span class=c1># early stopping reduces the risk of overfitting</span>
<span class=n>early_stopping</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>callbacks</span><span class=o>.</span><span class=n>EarlyStopping</span><span class=p>(</span><span class=n>patience</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
<span class=n>epochs</span> <span class=o>=</span> <span class=mi>100</span>
<span class=n>history</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>train_ds</span><span class=p>,</span> <span class=n>validation_data</span><span class=o>=</span><span class=n>val_ds</span><span class=p>,</span><span class=n>epochs</span><span class=o>=</span><span class=n>epochs</span><span class=p>,</span> <span class=n>callbacks</span><span class=o>=</span><span class=p>[</span><span class=n>early_stopping</span><span class=p>])</span>

<span class=n>loss</span><span class=p>,</span> <span class=n>accuracy</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>evaluate</span><span class=p>(</span><span class=n>test_ds</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Loss: &quot;</span><span class=p>,</span> <span class=n>loss</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Accuracy: </span><span class=si>{:2.2%}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>accuracy</span><span class=p>))</span>
</code></pre></div> <p>考虑到模型结构简单，效果还可以接受：</p> <div class=highlight><pre><span></span><code>782/782 [==============================] - 57s 72ms/step - loss: 0.4583 - accuracy: 0.8678
Loss:  0.45827823877334595
Accuracy: 86.78%
</code></pre></div> <h3 id=42-functional-apilstm>4.2 使用Functional API构建双向LSTM<a class=headerlink href=#42-functional-apilstm title="Permanent link">&para;</a></h3> <p>步骤与使用Sequential API类似，但Functional API更为灵活。</p> <div class=highlight><pre><span></span><code><span class=nb>input</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Input</span><span class=p>([</span><span class=kc>None</span><span class=p>]</span> <span class=p>)</span>
<span class=n>x</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Embedding</span><span class=p>(</span>
        <span class=n>input_dim</span><span class=o>=</span><span class=n>vocab_size</span><span class=p>,</span>
        <span class=n>output_dim</span><span class=o>=</span><span class=mi>128</span><span class=p>,</span>
        <span class=c1># Use masking to handle the variable sequence lengths</span>
        <span class=n>mask_zero</span><span class=o>=</span><span class=kc>True</span><span class=p>)(</span><span class=nb>input</span><span class=p>)</span>

<span class=n>x</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Bidirectional</span><span class=p>(</span><span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>LSTM</span><span class=p>(</span><span class=mi>64</span><span class=p>))(</span><span class=n>x</span><span class=p>)</span>
<span class=n>x</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Dense</span><span class=p>(</span><span class=mi>64</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s1>&#39;relu&#39;</span><span class=p>)(</span><span class=n>x</span><span class=p>)</span>
<span class=n>x</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Dropout</span><span class=p>(</span><span class=n>dropout_rate</span><span class=p>)(</span><span class=n>x</span><span class=p>)</span>
<span class=n>output</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Dense</span><span class=p>(</span><span class=n>num_labels</span><span class=p>)(</span><span class=n>x</span><span class=p>)</span>

<span class=n>lstm_model</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>Model</span><span class=p>(</span><span class=n>inputs</span><span class=o>=</span><span class=nb>input</span><span class=p>,</span> <span class=n>outputs</span><span class=o>=</span><span class=n>output</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s2>&quot;text_lstm_model&quot;</span><span class=p>)</span>

<span class=n>loss</span> <span class=o>=</span> <span class=n>losses</span><span class=o>.</span><span class=n>SparseCategoricalCrossentropy</span><span class=p>(</span><span class=n>from_logits</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=n>optimizer</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>optimizers</span><span class=o>.</span><span class=n>SGD</span><span class=p>(</span><span class=n>learning_rate</span><span class=o>=</span><span class=mf>0.01</span><span class=p>,</span> <span class=n>momentum</span><span class=o>=</span><span class=mf>0.9</span><span class=p>)</span>

<span class=n>lstm_model</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=n>loss</span><span class=o>=</span><span class=n>loss</span><span class=p>,</span> <span class=n>optimizer</span><span class=o>=</span><span class=n>optimizer</span><span class=p>,</span> <span class=n>metrics</span><span class=o>=</span><span class=s1>&#39;accuracy&#39;</span><span class=p>)</span>

<span class=n>lstm_model</span><span class=o>.</span><span class=n>summary</span><span class=p>()</span>
</code></pre></div> <p>输出为：</p> <div class=highlight><pre><span></span><code>Model: &quot;text_lstm_model&quot;
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_5 (InputLayer)        [(None, None)]            0         

 embedding_5 (Embedding)     (None, None, 128)         2560256   

 bidirectional_4 (Bidirectio  (None, 128)              98816     
 nal)                                                            

 dense_4 (Dense)             (None, 64)                8256      

 dropout_2 (Dropout)         (None, 64)                0         

 dense_5 (Dense)             (None, 2)                 130       

=================================================================
Total params: 2,667,458
Trainable params: 2,667,458
Non-trainable params: 0
_________________________________________________________________
</code></pre></div> <p>同样地，对模型进行训练与预测：</p> <div class=highlight><pre><span></span><code><span class=n>history_2</span> <span class=o>=</span> <span class=n>lstm_model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>train_ds</span><span class=p>,</span> <span class=n>validation_data</span><span class=o>=</span><span class=n>val_ds</span><span class=p>,</span> <span class=n>epochs</span><span class=o>=</span><span class=n>epochs</span><span class=p>,</span> <span class=n>callbacks</span><span class=o>=</span><span class=p>[</span><span class=n>early_stopping</span><span class=p>])</span>

<span class=n>loss</span><span class=p>,</span> <span class=n>accuracy</span> <span class=o>=</span> <span class=n>lstm_model</span><span class=o>.</span><span class=n>evaluate</span><span class=p>(</span><span class=n>test_ds</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Loss: &quot;</span><span class=p>,</span> <span class=n>loss</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Accuracy: </span><span class=si>{:2.2%}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>accuracy</span><span class=p>))</span>
</code></pre></div> <p>考虑到模型结构简单，效果还可以接受：</p> <div class=highlight><pre><span></span><code>782/782 [==============================] - 84s 106ms/step - loss: 0.4105 - accuracy: 0.8160
Loss:  0.4105057716369629
Accuracy: 81.60%
</code></pre></div> <h2 id=5>5 总结<a class=headerlink href=#5 title="Permanent link">&para;</a></h2> <p>关于文本分类，还有许多新的技术可以尝试，上述工作流中也还有许多决策可以做试验（炼丹），本文旨在使用最新的TensorFlow API过一遍文本分类任务中的重要知识点和常用API，实际工作中仍有许多地方可以优化。希望这次的分享对你有帮助，欢迎在评论区留言讨论！</p> <figure> <img src=https://cdn.jsdelivr.net/gh/BulletTech2021/Pics/2021-6-14/1623639526512-1080P%20(Full%20HD)%20-%20Tail%20Pic.png width=500> </figure> <!-- include "partials/source-date.html" --> <hr> <div style="display: flex;
  justify-content: center;
  align-items: center;"> <!-- LikeBtn.com BEGIN --> <span class=likebtn-wrapper data-theme=custom data-btn_size=32 data-f_size=14 data-icon_size=16 data-icon_l=thmb4-u data-icon_d=thmb4-d></span> <script>(function(d,e,s){if(d.getElementById("likebtn_wjs"))return;a=d.createElement(e);m=d.getElementsByTagName(e)[0];a.async=1;a.id="likebtn_wjs";a.src=s;m.parentNode.insertBefore(a, m)})(document,"script","//w.likebtn.com/js/w/widget.js");</script> <!-- LikeBtn.com END --> </div> <div class=md-source-date> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">May 21, 2022</span> <span id=busuanzi_container_site_pv style=float:right>Viewed <span id=busuanzi_value_page_pv></span> times</span> </small> </div> <script src=https://utteranc.es/client.js repo=BulletTech/User_Comments issue-term=pathname theme=preferred-color-scheme crossorigin=anonymous async>
 </script> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../2022-04-24-TensorFlow-Decision-Forest/ class="md-footer__link md-footer__link--prev" aria-label="Previous: 使用TensorFlow Decision Forests构建树模型" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> 使用TensorFlow Decision Forests构建树模型 </div> </div> </a> <a href=../2021-12-27-TensorFlow-Recommender2/ class="md-footer__link md-footer__link--next" aria-label="Next: TensorFlow推荐系统（二）" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> TensorFlow推荐系统（二） </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2021 - Now BulletTech </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-social> <a href=http://bullettech.cn/ target=_blank rel=noopener title=bullettech.cn class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M505.12 19.094c-1.19-5.532-6.658-11-12.207-12.188C460.716 0 435.507 0 410.407 0 307.175 0 245.27 55.203 199.052 128H94.838c-16.348.016-35.557 11.875-42.887 26.484L2.516 253.297A28.4 28.4 0 0 0 0 264a24.009 24.009 0 0 0 24.006 24h103.81l-22.474 22.469c-11.366 11.361-12.996 32.258 0 45.25l50.904 50.906c11.156 11.188 32.156 13.156 45.277 0l22.475-22.469V488a24.009 24.009 0 0 0 24.005 24 28.56 28.56 0 0 0 10.707-2.516l98.729-49.39c14.629-7.297 26.508-26.5 26.508-42.86V312.797C456.544 266.484 511.98 204.39 511.98 101.703c.094-25.203.094-50.406-6.86-82.61zM384.04 168a40 40 0 1 1 40.01-40 40.023 40.023 0 0 1-40.01 40z"/></svg> </a> <a href=https://mp.weixin.qq.com/s/YYZilgFSHrh-nrjF3Z2G7A target=_blank rel=noopener title=mp.weixin.qq.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><path d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154zm-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4zm-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2zM563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4zm-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6zm107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6z"/></svg> </a> <a href=https://www.zhihu.com/people/bullettech target=_blank rel=noopener title=www.zhihu.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><path d="M170.54 148.13v217.54l23.43.01 7.71 26.37 42.01-26.37h49.53V148.13H170.54zm97.75 193.93h-27.94l-27.9 17.51-5.08-17.47-11.9-.04V171.75h72.82v170.31zm-118.46-94.39H97.5c1.74-27.1 2.2-51.59 2.2-73.46h51.16s1.97-22.56-8.58-22.31h-88.5c3.49-13.12 7.87-26.66 13.12-40.67 0 0-24.07 0-32.27 21.57-3.39 8.9-13.21 43.14-30.7 78.12 5.89-.64 25.37-1.18 36.84-22.21 2.11-5.89 2.51-6.66 5.14-14.53h28.87c0 10.5-1.2 66.88-1.68 73.44H20.83c-11.74 0-15.56 23.62-15.56 23.62h65.58C66.45 321.1 42.83 363.12 0 396.34c20.49 5.85 40.91-.93 51-9.9 0 0 22.98-20.9 35.59-69.25l53.96 64.94s7.91-26.89-1.24-39.99c-7.58-8.92-28.06-33.06-36.79-41.81L87.9 311.95c4.36-13.98 6.99-27.55 7.87-40.67h61.65s-.09-23.62-7.59-23.62v.01zm412.02-1.6c20.83-25.64 44.98-58.57 44.98-58.57s-18.65-14.8-27.38-4.06c-6 8.15-36.83 48.2-36.83 48.2l19.23 14.43zm-150.09-59.09c-9.01-8.25-25.91 2.13-25.91 2.13s39.52 55.04 41.12 57.45l19.46-13.73s-25.67-37.61-34.66-45.86h-.01zM640 258.35c-19.78 0-130.91.93-131.06.93v-101c4.81 0 12.42-.4 22.85-1.2 40.88-2.41 70.13-4 87.77-4.81 0 0 12.22-27.19-.59-33.44-3.07-1.18-23.17 4.58-23.17 4.58s-165.22 16.49-232.36 18.05c1.6 8.82 7.62 17.08 15.78 19.55 13.31 3.48 22.69 1.7 49.15.89 24.83-1.6 43.68-2.43 56.51-2.43v99.81H351.41s2.82 22.31 25.51 22.85h107.94v70.92c0 13.97-11.19 21.99-24.48 21.12-14.08.11-26.08-1.15-41.69-1.81 1.99 3.97 6.33 14.39 19.31 21.84 9.88 4.81 16.17 6.57 26.02 6.57 29.56 0 45.67-17.28 44.89-45.31v-73.32h122.36c9.68 0 8.7-23.78 8.7-23.78l.03-.01z"/></svg> </a> <a href=https://github.com/BulletTech/BulletTech target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href="https://www.toutiao.com/c/user/token/MS4wLjABAAAAsxrzZdUCIQdOMU8albHKSb_ZCFAzIbwqzn9XFfIeoa-rd2rDsl7qOoCyd3wEgW5v/?source=feed" target=_blank rel=noopener title=www.toutiao.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M448 360V24c0-13.3-10.7-24-24-24H96C43 0 0 43 0 96v320c0 53 43 96 96 96h328c13.3 0 24-10.7 24-24v-16c0-7.5-3.5-14.3-8.9-18.7-4.2-15.4-4.2-59.3 0-74.7 5.4-4.3 8.9-11.1 8.9-18.6zM128 134c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm0 64c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm253.4 250H96c-17.7 0-32-14.3-32-32 0-17.6 14.4-32 32-32h285.4c-1.9 17.1-1.9 46.9 0 64z"/></svg> </a> <a href=https://www.douyin.com/user/MS4wLjABAAAAPFvcvoD4PrSqrAvA1ehFu9S3OL-oKdCqH_V54POznMI target=_blank rel=noopener title=www.douyin.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M448 209.91a210.06 210.06 0 0 1-122.77-39.25v178.72A162.55 162.55 0 1 1 185 188.31v89.89a74.62 74.62 0 1 0 52.23 71.18V0h88a121.18 121.18 0 0 0 1.86 22.17A122.18 122.18 0 0 0 381 102.39a121.43 121.43 0 0 0 67 20.14z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.tabs", "navigation.top"], "search": "../../../assets/javascripts/workers/search.8397ff9e.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": null}</script> <script src=../../../assets/javascripts/bundle.1e84347e.min.js></script> <script src=../../../javascripts/config.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> </body> </html>